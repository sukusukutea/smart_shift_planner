<div class="container-fluid">
  <div class="row min-vh-100">
    <div class="col-md-3 col-lg-2 p-0" style="background-color:#e6f0f0;">
      <%= render "layouts/sidebar" %>
    </div>

    <div class="col-md-9 col-lg-10 py-4">
      <div class="mx-auto text-center" style="width: 90%; min-width: 700px;">

        <div class="d-flex justify-content-center align-items-center mb-5">
          <h1 class="h4 fw-bold mb-0 me-3">曜日別人員配置（基本設定）編集</h1>

          <%= link_to "一覧へ戻る",
                      base_weekday_requirements_path,
                      class: "btn btn-outline-secondary btn-sm py-1 px-2" %>
        </div>

        <%= form_with url: base_weekday_requirements_path,
                      method: :patch,
                      local: true do %>

          <table class="table table-sm table-bordered align-middle mx-auto" style="max-width: 260px;">
            <thead>
              <tr class="text-center">
                <th rowspan="2" class="small py-1 lh-1" style="background-color:#e6f0f0;">曜日</th>
                <th colspan="4" class="small py-1 lh-1" style="background-color:#7fd9d2;">日勤</th>
                <th rowspan="2" colspan="1" class="small py-1 lh-1" style="background-color:#e6f0f0;">早番</th>
                <th rowspan="2" colspan="1" class="small py-1 lh-1" style="background-color:#e6f0f0;">遅番</th>
                <th rowspan="2" colspan="1" class="small py-1 lh-1" style="background-color:#e6f0f0;">夜勤</th>
              </tr>
              <tr class="text-center">
                <th class="small py-1 lh-1" style="background-color:#7fd9d2;">看護</th>
                <th class="small py-1 lh-1" style="background-color:#7fd9d2;">介護</th>
                <th class="small py-1 lh-1" style="background-color: #7fd9d2;">運転</th>
                <th class="small py-1 lh-1" style="background-color: #7fd9d2;">調理</th>
              </tr>
            </thead>

            <tbody>
              <% wdays = %w[月 火 水 木 金 土 日] %>
              <% 7.times do |i| %>
                <tr>
                  <td class="py-1"><%= wdays[i] %></td>

                  <td class="py-1">
                    <%= number_field_tag "weekday_requirements[#{i}][nurse]",
                                         @rows[i]["nurse"],
                                         min: 0,
                                         inputmode: "numeric",
                                         class: "weekday-req-input text-center border-0 bg-transparent p-0",
                                         style: "width: 2.8em; outline: none;" %>
                  </td>

                  <td class="py-1">
                    <%= number_field_tag "weekday_requirements[#{i}][care]",
                                         @rows[i]["care"],
                                         min: 0,
                                         inputmode: "numeric",
                                         class: "weekday-req-input text-center border-0 bg-transparent p-0",
                                         style: "width: 2.8em; outline: none;" %>
                  </td>

                  <td class="py-1">
                    <%= number_field_tag "weekday_requirements[#{i}][drive]",
                                         @rows[i]["drive"],
                                         min: 0,
                                         inputmode: "numeric",
                                         class: "weekday-req-input text-center border-0 bg-transparent p-0",
                                         style: "width: 2.8em; outline: none;" %>
                  </td>

                  <td class="py-1">
                    <%= number_field_tag "weekday_requirements[#{i}][cook]",
                                         @rows[i]["cook"],
                                         min: 0,
                                         inputmode: "numeric",
                                         class: "weekday-req-input text-center border-0 bg-transparent p-0",
                                         style: "width: 2.8em; outline: none;" %>
                  </td>

                  <td class="py-1">
                    <%= hidden_field_tag "weekday_requirements[#{i}][early]", 0 %>
                    <div class="form-check form-switch d-flex justify-content-center m-0">
                      <%= check_box_tag "weekday_requirements[#{i}][early]",
                                        1,
                                        @rows[i]["early"].to_i > 0,
                                        class: "form-check-input" %>
                    </div>
                  </td>

                  <td class="py-1">
                    <%= hidden_field_tag "weekday_requirements[#{i}][late]", 0 %>
                    <div class="form-check form-switch d-flex justify-content-center m-0">
                      <%= check_box_tag "weekday_requirements[#{i}][late]",
                                        1,
                                        @rows[i]["late"].to_i > 0,
                                        class: "form-check-input" %>
                    </div>
                  </td>

                  <td class="py-1">
                    <%= hidden_field_tag "weekday_requirements[#{i}][night]", 0 %>
                    <div class="form-check form-switch d-flex justify-content-center m-0">
                      <%= check_box_tag "weekday_requirements[#{i}][night]",
                                        1,
                                        @rows[i]["night"].to_i > 0,
                                        class: "form-check-input" %>
                    </div>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>

          <div class="mt-3">
            <%= submit_tag "保存", class: "btn btn-sm btn-primary" %>
            <%= link_to "キャンセル",
                        base_weekday_requirements_path,
                        class: "btn btn-sm btn-light border ms-2" %>
          </div>
        <% end %>

        <p class="text-muted small mt-2">
          ※ この設定は「新しく作成するシフト月」の初期値として使用されます。
        </p>

      </div>
    </div>
  </div>
</div>
